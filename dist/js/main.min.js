function rnd(n,m){return parseInt(Math.random()*(m-n)+n)}function addClass(ele,className){var oriClass=ele.className;oriClass?ele.className=oriClass+" "+className:ele.className=className}function removeClass(el,className){var cls=el.className;cls.indexOf(className)>=0&&(el.className=el.className.replace(new RegExp("(?:^|\\s)"+className+"(?=\\s|$)","ig"),""))}function replaceClass(el,cls1,cls2){removeClass(el,cls1),addClass(el,cls2)}window.onload=function(){function animateSpread(cb){hideNodes=0;for(var i=0;R>i;i++)for(var j=0;C>j;j++){var oNewDiv=document.getElementById("new_"+i+"_"+j);if(!oNewDiv)return void cb("no element");
//飞走——跟中心的距离——方向
var l=oNewDiv.offsetLeft+oNewDiv.offsetWidth/2,t=oNewDiv.offsetTop+oNewDiv.offsetHeight/2,disX=l-divCX,disY=t-divCY;!function(oNewDiv,disX,disY){setTimeout(function(){oNewDiv.style.WebkitTransform="perspective(800px) translate3d("+disX+"px, "+disY+"px, 600px) rotateY("+rnd(-180,180)+"deg) rotateX("+rnd(-180,180)+"deg) scale(2,2)",oNewDiv.style.opacity=0,setTimeout(function(){oDiv.removeChild(oNewDiv),hideNodes++,hideNodes==i*j&&cb&&cb()},600)},rnd(1,301))}(oNewDiv,disX,disY)}}function animateAggregate(cb){showNodes=0;for(var i=0;R>i;i++)for(var j=0;C>j;j++){
//创建
var w=Math.floor(oDiv.offsetWidth/C),h=Math.floor(oDiv.offsetHeight/R),oNewDiv=document.createElement("div");oNewDiv.id="new_"+i+"_"+j,oNewDiv.style.opacity=0,oNewDiv.style.left=j*w+"px",oNewDiv.style.top=i*h+"px",oNewDiv.style.width=w+"px",oNewDiv.style.height=h+"px";var offsetLeft=j*w,offsetTop=i*h,l=offsetLeft+w/2,t=offsetTop+h/2,disX=l-divCX,disY=t-divCY;oNewDiv.style.WebkitTransform="perspective(800px) translate3d("+disX+"px, "+disY+"px, 600px) rotateY("+rnd(-180,180)+"deg) rotateX("+rnd(-180,180)+"deg) scale(2,2)",oNewDiv.style.opacity=0,oNewDiv.style.backgroundPosition="-"+offsetLeft+"px -"+offsetTop+"px",oDiv.appendChild(oNewDiv),
//飞来——跟中心的距离——方向
function(oNewDiv,disX,disY){setTimeout(function(){oNewDiv.style.WebkitTransform="translate3d(0,0,0)",oNewDiv.style.opacity=1,showNodes++,showNodes==i*j&&cb&&cb()},rnd(300,500))}(oNewDiv,disX,disY)}}function hideAndShow(status,isBack){animateSpread(function(){animateAggregate(function(){isAnimating=!1})})}function bindEvents(){var ua=navigator.userAgent,android=ua.match(/(Android);?[\s\/]+([\d.]+)?/),ipad=ua.match(/(iPad).*OS\s([\d_]+)/),ipod=ua.match(/(iPod)(.*OS\s([\d_]+))?/),iphone=!ipad&&ua.match(/(iPhone\sOS)\s([\d_]+)/);android||ipad||ipod||iphone?$(".btn").on("touchstart",hideAndShow):$(".btn").on("click",hideAndShow)}var screen2=document.getElementById("screen_2"),oDiv=screen2.getElementsByClassName("ctn")[0],C=4,R=8,divCX=oDiv.offsetWidth/2,divCY=oDiv.offsetHeight/2,isAnimating=!1,showNodes=0,hideNodes=0;
// function init () {
// 	animateAggregate();
// 	bindEvents();
// }
// init();
bindEvents()};
/*!  最后修改于： 2016-01-19 */